FROM mcr.microsoft.com/dotnet/sdk:3.1

RUN mkdir /workshop/
WORKDIR /workshop/

RUN mkdir ./.github
RUN mkdir ./DotnetTemplate.Web
RUN mkdir ./DotnetTemplate.Web.Tests
RUN mkdir ./img

COPY .github ./.github
COPY DotnetTemplate.Web ./DotnetTemplate.Web
COPY DotnetTemplate.Web.Tests ./DotnetTemplate.Web.Tests
COPY img ./img

COPY \
    .editorconfig \
    DotnetTemplate.sln \
    DotnetTemplate.sln.DotSettings \
    Jenkinsfile \
    ./

RUN dotnet build

RUN curl -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.37.1/install.sh | bash
#RUN export NVM_DIR="$([ -z "${XDG_CONFIG_HOME-}" ] && printf %s "${HOME}/.nvm" || printf %s "${XDG_CONFIG_HOME}/nvm")"
#RUN export [ -s "$NVM_DIR/nvm.sh" ] && \. "$NVM_DIR/nvm.sh"

RUN export NVM_DIR="$HOME/.nvm"
RUN bash [ -s "$NVM_DIR/nvm.sh" ] && \. "$NVM_DIR/nvm.sh"
#RUN "$NVM_DIR/bash_completion" ] && \. "$NVM_DIR/bash_completion"root@c61a2d5c6420:/# [ -s "$NVM_DIR/bash_completion" ] && \. "$NVM_DIR/bash_completion"

#WORKDIR /workshop/DotnetTemplate.Web/
#RUN npm install
#RUN npm run build
